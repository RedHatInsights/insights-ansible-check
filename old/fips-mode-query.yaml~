- hosts: all
  user: root
  tasks:

  - name: Query sysctl crypto.fips_enabled
    command: sysctl -n crypto.fips_enabled 
    changed_when: no
    check_mode: no
    register: sysctl_task

  - debug: msg="Not fips mode {{ sysctl_task.stdout }}"
    when: sysctl_task == '0'

  - debug: msg="Yes fips mode {{ sysctl_task.stdout }}"
    when: sysctl_task == '1'


  - name: Is fips mode already enabled (sysctl crypto.fips_enabled)?
    debug: var=sysctl_task.stdout       

  - name: Is fips mode already enabled (sysctl crypto.fips_enabled)?
    set_fact:
      crypto_fips_enabled: "{{ sysctl_task.stdout == '0' }}"
    changed_when: sysctl_task.stdout != '0'

  - name: Is fips mode already enabled (sysctl crypto.fips_enabled)?
    debug: var=crypto_fips_enabled
    changed_when: crypto_fips_enabled 

